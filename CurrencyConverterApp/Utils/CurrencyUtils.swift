import Foundation

// Ð”Ð¾Ð¿Ð¾Ð¼Ñ–Ð¶Ð½Ð¸Ð¹ ÐºÐ»Ð°Ñ Ð´Ð»Ñ Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸ Ð· Ð²Ð°Ð»ÑŽÑ‚Ð°Ð¼Ð¸.
class CurrencyUtils {

    // Ð¤ÑƒÐ½ÐºÑ†Ñ–Ñ Ð´Ð»Ñ Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ð½Ð½Ñ Ð•Ð¼Ð¾Ð´Ð·Ñ–-Ð¿Ñ€Ð°Ð¿Ð¾Ñ€Ñƒ Ð·Ð° ÐºÐ¾Ð´Ð¾Ð¼ Ð²Ð°Ð»ÑŽÑ‚Ð¸
    static func flag(for currencyCode: String) -> String {
        
        // 1. ÐžÐ±Ñ€Ð¾Ð±ÐºÐ° Ð¡ÐŸÐ•Ð¦Ð˜Ð¤Ð†Ð§ÐÐ˜Ð¥ ÐºÐ¾Ð´Ñ–Ð²
        // Ð¢ÑƒÑ‚ Ð¼Ð¸ Ð²Ñ€ÑƒÑ‡Ð½Ñƒ Ð¿Ñ€Ð¾Ð¿Ð¸ÑÑƒÑ”Ð¼Ð¾ ÐµÐ¼Ð¾Ð´Ð·Ñ– Ð´Ð»Ñ Ð²Ð°Ð»ÑŽÑ‚, ÑÐºÑ– Ð½Ðµ Ð¼Ð°ÑŽÑ‚ÑŒ ÐºÐ¾Ð´Ñƒ ÐºÑ€Ð°Ñ—Ð½Ð¸
        switch currencyCode {
            // ÐÑ–Ð´ÐµÑ€Ð»Ð°Ð½Ð´ÑÑŒÐºÑ– ÐÐ½Ñ‚Ð¸Ð»Ð¸ (ÐšÑŽÑ€Ð°ÑÐ°Ð¾ Ñ‚Ð° Ð¡Ñ–Ð½Ñ‚-ÐœÐ°Ñ€Ñ‚ÐµÐ½)
            case "ANG": return "ðŸ‡¨ðŸ‡¼"
            
            // Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ð¾Ð°Ñ„Ñ€Ð¸ÐºÐ°Ð½ÑÑŒÐºÐ¸Ð¹ Ñ„Ñ€Ð°Ð½Ðº (ÐÑ„Ñ€Ð¸ÐºÐ°)
            case "XAF": return "ðŸŒ"
            
            // Ð¡Ñ…Ñ–Ð´Ð½Ð¾ÐºÐ°Ñ€Ð¸Ð±ÑÑŒÐºÐ¸Ð¹ Ð´Ð¾Ð»Ð°Ñ€ (ÐšÐ°Ñ€Ð¸Ð±Ð¸/ÐÐ¼ÐµÑ€Ð¸ÐºÐ°)
            case "XCD": return "ðŸŒŽ"
            
            // ÐšÐ°Ñ€Ð¸Ð±ÑÑŒÐºÐ¸Ð¹ Ð³ÑƒÐ»ÑŒÐ´ÐµÐ½ (Ð¿Ð»Ð°Ð½ÑƒÑ”Ñ‚ÑŒÑÑ Ð½Ð° Ð·Ð°Ð¼Ñ–Ð½Ñƒ ANG)
            case "XCG": return "ðŸŒŽ"
            
            // Ð¡Ð¿ÐµÑ†Ñ–Ð°Ð»ÑŒÐ½Ñ– Ð¿Ñ€Ð°Ð²Ð° Ð·Ð°Ð¿Ð¾Ð·Ð¸Ñ‡ÐµÐ½Ð½Ñ (ÐœÐ’Ð¤) - Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ”Ð¼Ð¾ "Ð‘Ð°Ð½Ðº"
            case "XDR": return "ðŸ¦"
            
            // Ð—Ð°Ñ…Ñ–Ð´Ð½Ð¾Ð°Ñ„Ñ€Ð¸ÐºÐ°Ð½ÑÑŒÐºÐ¸Ð¹ Ñ„Ñ€Ð°Ð½Ðº (ÐÑ„Ñ€Ð¸ÐºÐ°)
            case "XOF": return "ðŸŒ"
            
            // Ð¤Ñ€Ð°Ð½Ñ†ÑƒÐ·ÑŒÐºÐ¸Ð¹ Ñ‚Ð¸Ñ…Ð¾Ð¾ÐºÐµÐ°Ð½ÑÑŒÐºÐ¸Ð¹ Ñ„Ñ€Ð°Ð½Ðº (ÐŸÐ¾Ð»Ñ–Ð½ÐµÐ·Ñ–Ñ)
            case "XPF": return "ðŸ‡µðŸ‡«"
            
            default:
                // ÐŸÑ€Ð¾Ð´Ð¾Ð²Ð¶ÑƒÑ”Ð¼Ð¾ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñƒ Ð»Ð¾Ð³Ñ–ÐºÑƒ Ð´Ð»Ñ Ð²ÑÑ–Ñ… Ñ–Ð½ÑˆÐ¸Ñ…
                break
        }
        
        // 2. Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð° Ð»Ð¾Ð³Ñ–ÐºÐ°: Ð±ÐµÑ€ÐµÐ¼Ð¾ Ð¿ÐµÑ€ÑˆÑ– 2 Ð»Ñ–Ñ‚ÐµÑ€Ð¸ ÑÐº ÐºÐ¾Ð´ ÐºÑ€Ð°Ñ—Ð½Ð¸
        let base: UInt32 = 127397
        let countryCode = String(currencyCode.prefix(2))
        
        // ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÑÑ”Ð¼Ð¾, Ñ‡Ð¸ Ñ†Ðµ Ð²Ð°Ð»Ñ–Ð´Ð½Ñ– Ð»Ñ–Ñ‚ÐµÑ€Ð¸ (A-Z)
        guard countryCode.count == 2 &&
              countryCode.unicodeScalars.allSatisfy({ $0.value >= 65 && $0.value <= 90 }) else {
            return "ðŸ’°" // Ð—Ð°Ð¿Ð°ÑÐ½Ð¸Ð¹ Ð²Ð°Ñ€Ñ–Ð°Ð½Ñ‚ (Ð¼Ñ–ÑˆÐµÑ‡Ð¾Ðº), Ñ‰Ð¾Ð± Ñ€Ð¾Ð·Ð¼Ñ–Ñ€ Ð±ÑƒÐ² Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¸Ð¼
        }

        var flagString = ""
        for scalar in countryCode.unicodeScalars {
            if let regionalScalar = UnicodeScalar(base + scalar.value) {
                flagString.unicodeScalars.append(regionalScalar)
            }
        }
        return flagString
    }
}
